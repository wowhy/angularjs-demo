!function(a,b){"use strict";var c=b.module("hng",["ngSanitize","ui.router","ui.bootstrap","blockUI"]);c.config(["blockUIConfig",function(a){a.message="请稍等...",a.template='<div class="block-ui-overlay"></div><div class="block-ui-message-container" aria-live="assertive" aria-atomic="true"><div class="block-ui-message" ng-class="$_blockUiMessageClass"><span class="block-ui-loading"></span>&nbsp;&nbsp;{{ state.message }}</div></div>'}]),c.service("hngCore",["hngAjaxService","hngRESTfulService","hngGuid","hngModal","hngMsg","hngLocalStorage","hngSessionStorage",function(a,b,c,d,e,f,g){this.service={ajax:a,rest:b},this.utility={guid:c,modal:d,msg:e,localStorage:f,sessionStorage:g}}]),function(a){function b(a){return{scope:{hngModalUrl:"@",hngModalController:"@",hngModalCallback:"&"},link:function(b,c){c.on("click",function(){var c=a.show(b.hngModalUrl,b.hngModalController);b.hngModalCallback&&c.closed.then(b.hngModalCallback)})}}}a.directive("hngShowModal",["hngModal",b])}(c),function(a){a.service("hngAjaxService",["$http","$q","blockUI",function(a,c,d){function e(e,h,i,j){d.start();var k={method:h,url:e};k["POST"==h?"data":"params"]=i;var l=c.defer();return a(k).then(function(a){var b=g(a.data)?a.data:{success:!0,data:a.data,message:"操作成功!"};l.resolve(b)},function(a){var c=g(a.data)?a.data:{success:!1,status:a.status,data:b.isObject(a.data)?a.data:null,message:f(a.status)};l.resolve(c)}),l.promise.then(function(a){return d.stop(),b.isFunction(j)&&j(a),a})}function f(a){switch(a){case 404:return"未找到相关操作或资源!";case 405:return"服务器不允许此操作!"}return"服务器发生未知错误!"}function g(a){return b.isObject(a)&&void 0!==a.success&&(void 0!==a.data||void 0!==a.message)}this.get=function(a,c,d){return b.isFunction(c)&&(d=c,c={}),e(a,"GET",c,d)},this.post=function(a,c,d){return b.isFunction(c)&&(d=c,c={}),e(a,"POST",c,d)}}])}(c),function(a){function c(a,c){function f(a,f){function h(a,c,d,e){arguments.length&&b.isNumber(a)&&(b.isNumber(c)||(e=d,d=c,c=10),this.setPage(a,c).setOrder(d).setFilter(e))}function i(a){return e(a)?a:{success:!0,message:"操作成功!",data:a.value}}var j={Authorization:f},k=this,l=a+"(%1)",m=a+"(%1)",n=a+"(%1)",o=a,p=a,q=a;k.get=function(a){var e=g.get(d(l,a),{},j).then(function(a){return{success:!0,data:b.isObject(a)?a.data:a}},function(a){return{status:a.status,success:!1,data:a.data}});return c.all([e]).then(function(a){return a[0]})},k.all=function(a,b){var d=g.get(p,(new h).setOrder(a).setFilter(b),j).then(function(a){return{success:!0,data:a.data}},function(a){return{status:a.status,success:!1,data:a.data}});return c.all([d]).then(function(a){return a[0]})},k.query=function(a,d,f,k){var l=g.get(q,new h(a,d,f,k),j).then(function(a){return i(a.data)},function(a){var c=e(a.data)?a.data:{success:!1,status:a.status,data:b.isObject(a.data)?a.data:null};return c});return c.all([l]).then(function(a){return a[0]})},k.create=function(a){var b=g.post(o,a,j).then(function(a){return{success:!0,data:a.data}},function(a){return{status:a.status,success:!1,data:a.data}});return c.all([b]).then(function(a){return a[0]})},k.update=function(a){var b=g.post(d(n,a.Id),a,j).then(function(a){return{success:!0,data:a.data}},function(a){return{status:a.status,success:!1,data:a.data}});return c.all([b]).then(function(a){return a[0]})},k["delete"]=function(a){var b=g["delete"](d(m,a),model,j).then(function(a){return{success:!0,data:a.data}},function(a){return{status:a.status,success:!1,data:a.data}});return c.all([b]).then(function(a){return a[0]})},h.prototype={setPage:function(a,b){return this.$skip=(a-1)*b,this.$top=b,this},setOrder:function(a){return a&&(this.$order=serializeOrder(a)),this},setFilter:function(a){return a&&(this.$filter=serializeFilter(a)),this}}}var g=this;g.createModelProxy=function(a,b,c){c=c||{};var e=c.v,g=c.auth;a.lastIndexOf("/")!==a.length-1&&(a+="/"),e=e?e+"/":"";var h=d("%1%2%3",a,e,b);return new f(h,g)},g.get=function(b,c,d){return a({method:"GET",url:b,params:c,headers:d})},g.post=function(b,c,d){return a({method:"POST",url:b,data:c,headers:d})},g.put=function(b,c,d){return a({method:"PUT",url:b,data:c,headers:d})},g.patch=function(b,c,d){return a({method:"PATCH",url:b,data:c,headers:d})},g["delete"]=function(b,c,d){return a({method:"DELETE",url:b,params:c,headers:d})}}function d(a){var b=arguments,c=new RegExp("%([1-"+arguments.length+"])","g");return String(a).replace(c,function(a,c){return b[c]})}function e(a){return b.isObject(a)&&void 0!==a.success&&(void 0!==a.data||void 0!==a.message)}a.service("hngRESTfulService",["$http","$q",c])}(c),function(a){a.factory("hngGuid",[function(){return{newGuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)})}}}])}(c),function(a){function c(a){var c={};return c.show=function(c,d,e,f){f=f||{size:"md"};var g=b.extend(f,{templateUrl:c,windowTemplateUrl:"/hfefx/template/modal.html",controller:d,backdrop:"static",keyboard:!1,resolve:{$routeParams:function(){return e},$stateParams:function(){return e}}}),h=a.open(g);return{close:function(){h.close.apply(h,arguments)},closed:h.result,opened:h.opened}},c}a.factory("hngModal",["$uibModal",c]).run(["$rootScope","$uibModalStack",function(a,b){a.$on("$stateChangeSuccess",function(){b.dismissAll()})}])}(c),function(a){function c(a,c){var e={},f={templateUrl:"/hfefx/template/confirm.html",backdrop:"static",size:"sm",title:"提示消息",ok:"确定",cancel:"取消"},g={templateUrl:"/hfefx/template/alert.html",backdrop:"static",keyboard:!1,size:"sm",title:"提示消息",close:"关闭"},h={templateUrl:"/hfefx/template/prompt.html",backdrop:"static",size:"sm",title:"提示消息",ok:"确定",cancel:"取消"},i={templateUrl:"/hfefx/template/progress.html",backdrop:"static",keyboard:!1,size:"sm",title:"进度提示"};return e.confirm=function(e,g,h){0==arguments.length?e=value=g="":(h=b.isFunction(arguments[arguments.length-1])?arguments[arguments.length-1]:function(a){return a},g=b.isString(g)?g:f.title),e=e.replace(d,"<br />");var i={text:e,title:g,ok:f.ok,cancel:f.cancel},j=b.extend({},f,{scope:a.$new()});return j.scope.$dialog=i,c.open(j).result.then(h)},e.alert=function(e,f,h){0==arguments.length?e=value=f="":(h=b.isFunction(arguments[arguments.length-1])?arguments[arguments.length-1]:function(a){return a},f=b.isString(f)?f:g.title),e=e.replace(d,"<br />");var i={text:e,title:f,close:g.close},j=b.extend({},g,{scope:a.$new()});return j.scope.$dialog=i,c.open(j).result.then(h)},e.notify=function(){},e.prompt=function(e,f,g,i){0==arguments.length?e=f=g="":(i=b.isFunction(arguments[arguments.length-1])?arguments[arguments.length-1]:function(a){return a},f=b.isString(f)?f:"",g=b.isString(g)?g:h.title),e=e.replace(d,"<br />");var j={text:e,value:f,title:g,ok:h.ok,cancel:h.cancel},k=b.extend({},h,{scope:a.$new()});return k.scope.$dialog=j,c.open(k).result.then(function(a){return i(a===!1?null:a)})},e.progress=function(d,e){function f(d,e){var f=b.extend({},i,{scope:a.$new()}),g=f.scope;g.safeApply=function(a){var b=this.$root.$$phase;"$apply"==b||"$digest"==b?a&&"function"==typeof a&&a():this.$apply(a)};var h=g.$progress={title:d,stacked:[],max:e},j=c.open(f);return j.setValue=function(a,b){g.safeApply(function(){for(var c=0;c<h.stacked.length;c++){var d=h.stacked[c];if(d.type==a)return void(d.value=b)}h.stacked.push({type:a,value:b})}),this.getValue()>=e&&this.complete()},j.getValue=function(a){if(void 0!==a){for(var c=0;c<h.stacked.length;c++){var d=h.stacked[c];if(d.type==a)return d.value}return 0}var e=0;return b.forEach(h.stacked,function(a){e+=a.value}),e},j.increment=function(a){a=a||"success",this.setValue(a,this.getValue(a)+1)},j.complete=function(){this.close(!0)},j}return d=d?d:i.title,e=b.isNumber(e)?e:100,f(d,e)},e}a.factory("hngMsg",["$rootScope","$uibModal",c]);var d=new RegExp("\n")}(c),function(b){function c(){return e("localStorage")}function d(){return e("sessionStorage")}function e(b){function c(){try{return h in d&&d[h]}catch(a){return!1}}var d=a;if(e._storeCache=e._storeCache||{},e._storeCache[b])return e._storeCache[b];var f,g={},h=(d.document,b);if(g.disabled=!1,g.serialize=function(a){return JSON.stringify(a)},g.deserialize=function(a){if("string"==typeof a)try{return JSON.parse(a)}catch(b){return a||void 0}},c()){g.supported=!0,f=d[h],g.set=function(a,b){return void 0===b?g.remove(a):(f.setItem(a,g.serialize(b)),b)},g.get=function(a){return g.deserialize(f.getItem(a))},g.remove=function(a){f.removeItem(a)},g.clear=function(){f.clear()},g.getAll=function(){var a={};return g.forEach(function(b,c){a[b]=c}),a},g.forEach=function(a){for(var b=0;b<f.length;b++){var c=f.key(b);a(c,g.get(c))}};try{var i="__storejs__";g.set(i,i),g.get(i)!=i&&(g.disabled=!0),g.remove(i)}catch(j){g.disabled=!0}g.enabled=!g.disabled}else g.supported=!1,g.enabled=!1;return e._storeCache[b]=g,g}b.factory("hngLocalStorage",[c]),b.factory("hngSessionStorage",[d])}(c),b.module("hng").run(["$templateCache",function(a){a.put("/hfefx/template/alert.html",'<div class="modal-header"><h4 class="modal-title">{{ $dialog.title }}&nbsp;</h4></div><div class="modal-body" ng-bind-html="$dialog.text"></div><div class="modal-footer"><button type="submit" dlg-focus ng-click="$close()" class="btn btn-primary">{{ $dialog.close }}</button></div>'),a.put("/hfefx/template/confirm.html",'<div class="modal-header"><button type="button" class="close" ng-click="$close(false)" aria-hidden="true">×</button><h4 class="modal-title">{{ $dialog.title }}&nbsp;</h4></div><div class="modal-body" ng-bind-html="$dialog.text"></div><div class="modal-footer"><button type="submit" dlg-focus ng-click="$close(true)" class="btn btn-primary">{{ $dialog.ok }}</button> <button ng-click="$close(false)" class="btn btn-default">{{ $dialog.cancel }}</button></div>'),a.put("/hfefx/template/modal.html",'<div modal-render="{{$isRendered}}" tabindex="-1" role="dialog" class="modal" uib-modal-animation-class="fade" modal-in-class="in" ng-style="{\'z-index\': 1050 + index*10, display: \'block\'}"><div class="modal-dialog" ng-class="size ? \'modal-\' + size : \'\'" ng-style="{\'width\': width}"><div class="modal-content" uib-modal-transclude></div></div></div>'),a.put("/hfefx/template/progress.html",'<div class="modal-header"><h4 class="modal-title">{{ $progress.title }}&nbsp;</h4></div><div class="modal-body"><uib-progress max="$progress.max"><uib-bar ng-repeat="bar in $progress.stacked track by $index" value="bar.value" type="{{bar.type}}"><span>{{bar.value}}</span></uib-bar></uib-progress></div>'),a.put("/hfefx/template/prompt.html",'<div class="modal-header"><button type="button" class="close" ng-click="$close(false)" aria-hidden="true">×</button><h4 class="modal-title">{{ $dialog.title }}&nbsp;</h4></div><form><div class="modal-body"><div ng-bind-html="$dialog.text"></div><input class="form-control" dlg-focus ng-model="$dialog.value"></div><div class="modal-footer"><button type="submit" ng-click="$close($dialog.value)" class="btn btn-primary">{{ $dialog.ok }}</button> <button ng-click="$close(false)" class="btn btn-default">{{ $dialog.cancel }}</button></div></form>')}])}(window,angular);